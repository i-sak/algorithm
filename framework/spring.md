Spring bean

speing bean과 의존 관계

1. 빈(Bean)
    - java에서 bean은 일반적으로 재사용 가능한 sw 구성요소를 의미
    - java based f/w container에서 객체를 가리킬 때 사용
    - Xml file이나 Java Configuration 파일에 Bean 설정 정보 작성
    - 의존성 주입을 통해 Bean과 상호작용 -> 느슨한 결합

2. 의존성 주입(Dependency Injection)
    - 직접 의존하는 객체를 생성하지 않고, 외부에서 의존 객체를 주입받아 사용
    - 내부에서 직접 생성하는 것이 아닌, 의존 객체를 매개변수로 전달받아 주입
    - xml, java configuration file에서 관련 빈들의 의존관계 설정
    - spring IoC container는 설정 정보를 기반으로 필요한 빈을 생성하고 의존하는 빈들을 주입하여, 객체간의 관계를 자동으로 관리
    - 객체간의 결합도를 낮춰주기에 확장성있고 유연한 설계가 가능

3. IoC(Inversion of Control)
    - 제어의 권한이 역전 되었다 하여 "제어의 역전"
    - 객체의 제어 권한을 개발자가 갖는 것이 아닌 f/w나 컨테이너에 위임
    - f/w가 대신 처리하여 객체를 제공하고 관리
    - IoC를 구현하는 방법중 하나가 바로 DI
    - IoC와 DI는 서로 연결된 개념

4.  DIP
    - 상위레벨의 모듈은 하위레벨의 모듈에 의존하지 않는다. 둘다 추상화에 의존해야한다.


5. spring bean & spring IoC Container
    - 스프링 빈 : Spring IoC Container가 관리하는 객체
    - 스프링 IoC 컨테이너
        - 빈을 관리하는 객체
        - 객체의 lifecycle 관리
        - DI를 통해 객체들 간의 관계 관리
        - 빈으로 등록된 객체 생성, 필요한 곳에서 사용될 수 있도록 제공

6. spring 의존 관계 자동 주입
    - 필드 주입 방식
        - 필드에 바로 주입하는 방식
        - 코드가 간결해짐
        - 외부에서 변경이 불가능 (test시 제약)
        - DI f/w에 종속적
        - test code에서만 보통 사용
    - setter 주입 방식 (많이 사용하지 않음)
        - setter에 의존 관계 주입
        - 선택적이고 변경 가능성이 있는 의존 관계에 주입
        - 자바빈 프로퍼티 규약의 수정자 메서드에 주입
    - 일반 메서드 주입 방식 (많이 사용하지 않음)
        - 일반 메서드를 통해서도 주입이 가능
        - 한번에 여러 필드를 주입할 수 있음
        - 정말 특이한 경우가 아니라면 사용 x
    - 생성자 주입 방식 (*권장*)
        - 스프링에서 권장하는 의존성 주입 방식
        - 대부분의 의존 관계 주입은 어플리케이션 종료까지 변경할 일 X
        - 생성자 주입 방식은 불변을 보장 (객체 생성 시 딱 1번만 생성자 호출)
        - 필요한 의존성 명시적으로 표현, 누락을 방지함
        - 테스트가 용이해짐
        - 순환 참조 문제 발생 방지

7. 여러 개 동일한 빈이 존재하면
    - @Primary : 우선순위
    - @Qualifier : 명시적

8. Bean scope
    - Singleton
        - Singleton 스코프가 기본값
        - Spring container 내에서 하나의 인스턴스만 생성되고 공유
        - 모든 요청은 동일한 instance가 반환 됨
        - spring container가 생성되는 시점에 미리 인스턴스화
        - application의 전역 공유 객체로 사용
    - Prototype (자주 사용 x)
        - 요청 마다 새로운 인스턴스가 생성
        - 요청할 때 마다 새로운 객체가 생성되고 반환
        - 스프링 컨테이너에 의해 요청이 있을 때 마다 인스턴스화
        - 상태를 가지는 객체나 스레드에 안전하지 않은 객체에 적합
    - Request
        - 웹 어플리케이션 요청 마다 새로운 인스턴스 생성
        - HTTP 요청 마다 새로운 bean 인스턴스가 생성, 해당 요청 범위 내에서 공유
        - 웹 어플리케이션의 요청 내에서 객체가 공유 되어야할 때 사용
    - Session
        - 세션당 하나의 인스턴스가 생성되는 스코프
        - 사용자 세션이 생성될 때 마다 새로운 빈 인스턴스 생성, 해당 범위 내에서 공유
        - 세션당 객체를 공유해야 할 때 사용
    - Application
        - 어플리케이션 전역에 하나의 인스턴스만 생성